module selinux-contrail-qemu 1.0;

require {
        type ifconfig_t;
        type tun_tap_device_t;
        type svirt_t;
        class tun_socket { relabelfrom relabelto };
        class chr_file open;
}

#============= svirt_t ==============
allow svirt_t ifconfig_t:tun_socket relabelfrom;
allow svirt_t self:tun_socket { relabelfrom relabelto };

#!!!! This avc is allowed in the current policy
allow svirt_t tun_tap_device_t:chr_file open; 
